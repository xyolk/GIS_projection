<view class="page-container">

<map 
  id="myMap"
  class="map-bg"
  longitude="{{longitude}}"
  latitude="{{latitude}}"
  scale="{{scale}}"
  markers="{{markers}}"
  show-location="true"
  bindmarkertap="onMarkerTap"
  bindtap="onMapTap"
  enable-satellite="{{enableSatellite}}"
>
  </map>

<view class="ui-layer">
  
  <view class="top-bar">
    <t-icon name="view-list" size="48rpx" color="#666" />
    
    <view class="search-box" bindtap="onSearch">
      <t-icon name="search" size="40rpx" color="#999" class="search-icon" />
      <text class="search-placeholder">搜索美食或地点</text>
    </view>
    <t-icon name="notification" size="48rpx" color="#666" />
  </view>

  <view class="map-controls">
    <view class="control-btn" bindtap="onShowLayers">
      <t-icon name="layers" size="44rpx" color="#4b5563" />
    </view>
    <view class="control-btn" bindtap="initMap">
      <t-icon name="location" size="44rpx" color="#ff9800" />
    </view>
  </view>

  <view class="bottom-sheet">
    
    <scroll-view scroll-x class="filter-scroll" enable-flex>
      <block wx:for="{{filters}}" wx:key="name">
        <view 
          class="filter-tag {{item.active ? 'active' : ''}}" 
          bindtap="onFilterTap" 
          data-index="{{index}}"
        >
          {{item.name}}
        </view>
      </block>
    </scroll-view>


    <scroll-view scroll-y class="restaurant-scroll" style="height: 50vh;">
      <view class="restaurant-list">
        <block wx:for="{{restaurants}}" wx:key="id">
          <view class="restaurant-card" id="card-{{item.id}}">
            <view class="card-content">
              <view class="card-image" style="background-color: {{item.imageColor}}"></view>
              <view class="card-info">
                <view class="shop-name">{{item.name}}</view>
                <view class="shop-rating-row">
                  <t-icon name="star-filled" size="28rpx" color="#fbbf24" />
                  <text class="rating-num">{{item.rating}}</text>
                  <text class="divider">·</text>
                  <text class="tag-text">{{item.tags[0]}}</text>
                </view>
                <view class="shop-location-row">
                  <t-icon name="location" size="28rpx" color="#9ca3af" />
                  <text class="location-text">{{item.location}}</text>
                </view>
                <view class="shop-price-row">
                  <text class="price-text">¥{{item.price}}/人</text>
                  <text class="distance-text">{{item.distance}}</text>
                </view>
              </view>
            </view>
            
            <view class="card-actions">
              <view class="action-btn" bindtap="onNavigate"><t-icon name="navigation-arrow" size="40rpx" color="#666" /></view>
              <view class="action-btn" bindtap="onFavorite"><t-icon name="heart" size="40rpx" color="#666" /></view>
              <view class="action-btn" bindtap="onCall"><t-icon name="call" size="40rpx" color="#666" /></view>
            </view>
          </view>
        </block>
        <view style="height: 120rpx;"></view>
      </view>
    </scroll-view>

  </view>
</view>


<view class="tab-bar">
  <view class="tab-item {{currentTab === 'explore' ? 'active' : ''}}" bindtap="switchTab" data-tab="explore">
    <t-icon name="compass" size="48rpx" /> <text class="tab-text">探索</text>
  </view>
  <view class="tab-item" bindtap="switchTab" data-tab="social">
    <t-icon name="usergroup" size="48rpx" /> <text class="tab-text">社媒</text>
  </view>
  <view class="tab-item" bindtap="switchTab" data-tab="collection">
    <t-icon name="heart" size="48rpx" />
    <text class="tab-text">收藏</text>
  </view>
  <view class="tab-item" bindtap="switchTab" data-tab="settings">
    <t-icon name="setting" size="48rpx" />
    <text class="tab-text">设置</text>
  </view>
</view>
</view>